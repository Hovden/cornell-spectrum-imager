// "StartupMacros"
// The macros and macro tools in this file ("StartupMacros.txt") are 
// automatically installed in the Plugins>Macros submenu and
//  in the tool bar when ImageJ starts up.
//
// Icons contributed by Tony Collins.

   // Global variables
   var pencilWidth=1,  eraserWidth=10, leftClick=16, alt=8;
   var brushWidth = 10; //call("ij.Prefs.get", "startup.brush", "10");
   var floodType =  "8-connected"; //call("ij.Prefs.get", "startup.flood", "8-connected");

   // The macro named "AutoRun" runs when ImageJ starts.
   // macro "AutoRun" {print("AutoRun");}

   // The macro named "AutoRunAndHide" runs when ImageJ starts
   // and the file containing it is not displayed when ImageJ opens it.
   // macro "AutoRunAndHide" {}



  //macro "Unused Tool -" {}

  var pmCmds = newMenu("Popup Menu",
       newArray("Help...", "Rename...", "Duplicate...", "Original Scale", 
       "Paste Control...", "-", "Record...", "Capture Screen ", "Monitor Memory...", 
       "List Commands...", "Control Panel...", "Startup Macros...", "Search..."));

  macro "Popup Menu" {
      cmd = getArgument();
      if (cmd=="Help...")
           showMessage("About Popup Menu",
               "To customize this menu, edit the line that starts with\n\"var pmCmds\" in ImageJ/macros/StartupMacros.txt.");
      else
          run(cmd);
  }

   
  var xx = requires138b(); // check version at install
  function requires138b() {requires("1.38b"); return 0; }

     var dCmds = newMenu("Developer Menu Tool",
      newArray("ImageJ Website","News", "Documentation", "ImageJ Wiki", "Resources", "Macro Language", "Macros", 
      "Macro Functions", "Startup Macros...", "Plugins", "Source Code", "Mailing List Archives", "-", "Record...", 
      "Capture Screen ", "Monitor Memory...", "List Commands...", "Control Panel...", "Search...", "Debug Mode"));
      
  

  

  macro "Set Drawing Color..."{ 
      run("Color Picker..."); 
  }

  macro "-" {} //menu divider

  macro "About Startup Macros..." {
      path = getDirectory("macros")+"/About Startup Macros";
      if (!File.exists(path))
          exit("\"About Startup Macros\" not found in ImageJ/macros/.");
      open(path);
  }

  macro "Save As JPEG... [j]" {
     quality = call("ij.plugin.JpegWriter.getQuality");
     quality = getNumber("JPEG quality (0-100):", quality);
     run("Input/Output...", "jpeg="+quality);
     saveAs("Jpeg");
  }

// Toolbar for Cornell Spectrum Imager
// 
var v=versionCheck();
function versionCheck() {
    requires("1.41f");
    return 1;
}

var CSI_folder='CSI EELS';

macro "Line Profile Action Tool- CfffD00D01D02D0eD0fD10D11D12D1dD1eD1fD20D21D22D2dD2eD2fD30D31D32D3dD3eD3fD40D41D42D4dD4eD4fD50D51D52D5dD5eD5fD60D61D62D6dD6eD6fD70D71D72D7dD7eD7fD80D81D82D8eD8fD90D91D92D9dD9eD9fDa0Da1Da2DadDaeDafDb0Db1Db2DbdDbeDbfDc0Dc1Dc2DcdDceDcfDd0Dd1Dd2DddDdeDdfDe0De1De2DedDeeDefDf0Df1Df2DfeDffCeeeD14CeeeDe8CeeeDa4CeeeD54CdeeDebCbddD88CceeD38CceeDdbCceeD8bCdeeD2bC4bbDb8C4bbDb9C4bbDbaC5bbD59C5bbD6aD9aDaaC5bbD5aC5bbD7aC5bbD8aC5bbD4aC6bcD47C6ccD89C6ccD58C6ccDcaC7ccDb7C7ccDa9C7ccD3aC7ccDc9C8ccD69C8ccD99C9ccDeaC9ddDa8CaddD57C5bbD48C5bbD49C7ccD79C7ccDdaC8ccDc8C8ccDc7C9ddDc6C9ccD2aC9ddD46CbeeD78CbddDc5CceeD39CceeD68CceeD3bCceeD37CceeD9bDabDbbCceeD98CceeD5bD6bD7bDcbCceeD4bCdeeDb5CdeeD56CdeeDd5CdeeDd9CdeeD65CdeeD85CdeeDd6CdeeDe9CdeeDd8CdeeD55CdeeD96CdeeD76D86CdeeDd7CeeeD87CeeeD97CeeeDc4CeeeDd4CeeeD64D74D84D94Db4CeeeDe7CeeeD34CeeeDe4CeeeDe6CeeeDa6CeeeD27CeeeD24CeeeD44CeeeD1aCeeeD29CfffD1bCeffD17CeeeD18CbddDb6CceeDa7CceeD36CcedD45CdeeD35CdeeD95CdeeD75CdeeD77Da5CeeeDe5CeeeD66CdeeD25CeeeD67CeeeD28CeeeD26CefeD16CeeeD19CeeeD15C444D04C333Df4C111D05D06D07D08D09D0aD0b" {
      
	run("Dynamic Profiler");
  
}


macro "Open Spectrum Action Tool - C10fDc4C0d0D96CfffD00D01D02D03D04D0dD0eD0fD10D11D12D13D1eD1fD20D21D22D23D2eD2fD30D31D32D33D3eD3fD40D41D4eD4fD50D51D5eD5fD60D61D62D6eD6fD70D71D72D7eD7fD80D81D82D8eD8fD90D91D92D9eD9fDa0Da1Da2DaeDafDb0Db1Db2DbdDbeDbfDc0Dc1Dc2DcdDceDcfDd0Dd1Dd2DdbDdcDddDdeDdfDe0De1De2De5De6DeaDebDecDedDeeDefDf0Df1Df2Df3Df4Df5Df6Df9DfaDfbDfcDfdDfeDffCf64D53CccbDf8Cfe0D76Cfc2D16D17D18D19D1aD25D26D27D28D29D2cD35D36D37D38D3bD3cD4aD4bD4cD59D5aD5bD5cD68D69D6aD6bD6cD78D79D7aD7bD7cD88D89D8aD8bD8cD98D99D9aD9bD9cDa8Da9DaaDabDb8Db9DbaDbbDc8Dc9DcaDd8Dd9C9dbDb3C0c4Da5CedeDe3Ccf6D93Cf20D45D46C20eDb6C0f0Da4CdbeDd3Cfe1D75CccbD0bCad0D86CfeeD42D52Cfd4D73Cba5DcbC00fDb5CccbD06Cff0D84D85CccbD07D08D09D0aC5f3D94CeeeD0cCfe3D74Cc81D49Cc8cDe4C0f0D95CeceDd6C7f7Da3CfffD05Cff3D83Cc82D67Cd61D57Ccb7D34C13eDb4CddcD14CfeeDccCda2Da7CbbfDc3CeedDf7Ca95D2dD3dD4dD5dD6dD7dD8dD9dCf20D47Cba6DdaCeb2D2aD87D97Cb82D2bCf72D64D65D66Cba8D1dCca3D15C249Da6Cf11D44Cb96DbcCda2D77Cf61D55Ccb8D24Cfb2D1bDe8Cd30D48Cba7De9Cc92D3aCf82D63CbbaDadCcb8Dd7Ca82D1cCd92D58Cf22D43C71aDc5Cda2D39DacCf61D56Cf52D54Ccb9De7C843Db7C939Dd5Ca66Dc7" {
	path = File.openDialog("Select a File to Open");
  
  	dir = File.getParent(path);
  	name = File.getName(path);

   	ext=substring(path, lastIndexOf(path, "."), lengthOf(path));

	if (ext == ".dm3") {
                run("CSI DM3 Reader", "load=[&path]");
                return;
        } 
	else if ( ext == ".ser" ) {
		run("CSI TIA Reader", "load=[&path]");
		return;
	}
	else
	{
		open(path);
	}

}


macro 'Subtract Dark Reference Action Tool - CcfcDc5C1f1D02D82C666D13D14D15D16D17D18D19D24D25D26D27D28D29D35D36D37D38D39D45D46D47D48D49D56D57D58D59D66D67D68D69D76D77D78D79D84D85D86D87D88D89D95D96D97D98D99Da6Da7Da8Da9Db7Db8Db9Dc8Dc9Dd9Ce10DfaC6f6Df8C575Dc7C888D1aD2aD5aD6aD9aDaaDdaDeaC222D1bD1cD1dD1eD2bD2cD2dD2eD3bD3cD3dD3eD4bD4cD4dD4eD5bD5cD5dD5eD6bD6cD6dD6eD7bD7cD7dD7eD8bD8cD8dD8eD9bD9cD9dD9eDabDacDadDaeDbbDbcDbdDbeDcbDccDcdDceDdbDdcDddDdeDebDecDedDeeC3b3D55CfffD20D30D31D40D41D42D50D51D52D53D60D61D62D63D70D80D90D91Da0Da1Da2Db0Db1Db2Db3Dc0Dc1Dc2Dc3Dc4Dd0Dd1Dd2Dd3Dd4Dd5De0De1De2De3De4De5De6Df0Df1Df2Df3Df4Df5Df6Df7Ca61D0aCafaD10Dd6C4f4D72C2c2D05Cc44D4aC131D0fDfdC494Da5C4f4D71C3f3D01D81CdfdDb4C1d1D07C8e8D21D43C4b4D03C3e3Da4C040D7fD8fD9fDafDbfDcfDdfDefC2d2D11D33D44Ce22D7aDcaC5f5D54C040D0dD0eC1e1D74Dd7Df9C121DfbDfcCd22D8aC484D83Db6C2d2D65Dc6C2c2D04C575D75De9C040D0bD0cDffCe11D3aC7f7D32C666D23Dd8C030D1fD2fD3fDfeCafaD92CcfcDa3CefeD00C575D12D34Ce11DbaC1d1D08D09D22C1f1D73C8f8D64C494D94C2e2D93C1f1Db5C040C2c2D06C2c2De8C7f7De7' {
	run("CSI Darkref Subtractor");
}

macro 'Cornell Spectrum Imager Action Tool - C777D7cDcdC0f0D50D51D52D53D54D55D56D57D58D59D5aD5bD5cD5dD5eD5fDb0Db1Db2Db3Db4Db5Db6Db7Db8Db9DbaDbbDbcDbdDbeDbfC353DecC231D97CcccD07D09D0aD0bC400D20D30D42D72D90Dd0Dd1Dd2C300D71Ca98D79C666D19D1aD1bD1cD1dD1eD1fD29D2aD2bD2cD2dD2eD2fD3aD3bD3cD3dD3eD3fD4bD4cD4dD4eD4fD6dD6eD6fD7dD7eD7fD8cD8dD8eD8fD9cD9dD9eD9fDacDadDaeDafDceDcfDdfDefC433D21CdddD99DedDfeC420Da7Dc6C100D60C666D18D6cD9bDdeC241DcaC9a9DdcC410D15Dd5CeeeD49D88C400De0C010D25D35D45D65C564De8C777D8bCbbbD7aC310D85C421Dc8C110D75C999D4aC800D02C976D78D98CbbbD28DffC332Da6C421Dc7Df7C300D11D81C444D91De1De2C010D34D44D64CfffDccC575DcbC020D36D66D76C454D04Da5CaaaDabC431DdaC410D46C987D16C242DdbCaaaD39D9aCcccD89C522D03C200D10D80C120D86C444D12D31D41D83Da1C787Da9C300D01D61Df0CcccD0fDddC000D33D43D63Dc3C531DeaDf9C454De5De6C311D22C400D32D73Da2C010D24CdddD38D87CfffD06D6bD7bC665D6aC443D95C787DfdC331Dc9C333D94C410Dd7Dd8Df6C999D8aDeeC120D26C000Dc0C410Dd6C400D93Df4C454D05C310D14D74Da4Dd4C444De3De4C554D77C443D84C242D37DebDfbC343DfcC520D69Dd9Df8C300D40Da0Dd3C300D23D62C200Da3CcbbD27C220D47CeddDaaCcccD08D0cD0dD0eD17C010Dc4C200Dc1Dc2C531D48C400Df1Df2Df3C311D92C420D68C000D70C564De9C431DfaC210Dc5C431Da8C410D96C321D13C120D67C410Df5C454De7C444D82'{
	run("CSI Spectrum Analyzer");
}


macro 'Extract Slice Action Tool - C000D00D01D02D03D04D05D06D07D08D09D0aD0bD0cD0dD0fD10D11D12D13D14D1dD1fD20D21D22D23D2dD2fD30D31D32D3dD3fD40D41D4dD4fD50D51D5dD5fD60D61D6dD6fD70D71D7dD7fD80D81D8dD8fD90D91D9dD9fDa0Da1DacDadDb0Db1DbbDbcDbdDc0Dc1Dc2Dc3Dc4Dc5DcaDcbDccDcfDd0Dd1Dd2Dd3Dd4Dd5Dd9DdaDdbDdcDdfDe0De1De2De3De4De5De8De9DeaDebDecDedDefDf0Df1Df2Df3Df4Df5Df7Df8Df9DfaDfbDfcDfdDfeDffC000Df6C100DddDeeCcccD37D38D39D47D48D57D58D67D68D69D77D78D79D87D88Cc00DbeCb00D2eD3eD4eD5eD6eD7eD8eD9eDaeCeeeDa3Dc8C555D29C300DbfCdddD98Da7CcccD28D36D3bD46D4aD4bD56D5bD66D6bD76D7bD86D8bD95D96D97Da4CfffD35D44D45D53D54D55D63D64D65D73D74D75D83D84D93Da8Db7Db8Dc7C444D16D17Db2C100D0eCbbbD27D2bD59D5aD6aD7aDa5Da6CfffD85D94D99Da9C888DaaCa00DdeCeeeD3aDb9Dd7C222D15D24CbbbD26D3cD49D4cD5cD6cD7cD8aC777Db6Dc6Dd6C600DcdCdddD25D2aD34D43D89C444D18D1aD52D62D72D82D92Da2C200DafCaaaD9aD9bCa00D1eC111DbaCe00DceC666Db3De6C999D8cC333D1bD1cDc9Dd8De7C111D19D9cDabC666Db4Db5C222D33D42CaaaD2c'{
	select = getSliceNumber();
	name = getTitle()+" "+getInfo("slice.label");
	run("Z Project...", "start=&select stop=&select projection=[Sum Slices]");
	rename(name);
}




macro 'RGB Composite Action Tool - C000D00D01D02D03D04D05D06D07D0cD0dD0eD0fD10D11D12D13D14D15D1eD1fD20D21D22D23D24D2eD2fD30D31D32D3fD40D41D4fD50D5fD60D6fD7fD8fD90D9fDa0DafDb0Db1DbfDc0Dc1Dc2DcfDd0Dd1Dd2Dd3Dd4Dd5DdeDdfDe0De1De2De3De4De5DeeDefDf0Df1Df2Df3Df4Df5Df6Df7DfcDfdDfeDffC001D80C100DedC00fD43D44D52D53D54D62D63D64D71D72D73D74D81D82D83D84D92D93D94Da2Da3Da4Db3Db4C0d0D26Cf00D9dDabDacDadDbaDbbDbcDbdDc9DcaDcbDccDcdDd7Dd8Dd9DdaDdbDdcDe8De9DeaDebC07eD35Cc0aDc7C400D8eCb0fD95Db5C0f1D38Cf20DaaCf1fD96C090D6eC020D16C0f0D18D19D1aD1bD27D28D29D2aD2bD2cD39D3aD3bD3cD3dD4aD4bD4cD4dD5bD5cD5dD6dC0efD48Cf00Dc8Ca00DbeDecCf0fDa6Da7Db6Db7Cff0D7bD7cD8bD8cCf70D9cCfffD69D77D78D79D87D88D89D98D99C006Da1C100De6C07fD75C00dD91C600DceDf9Cd0fDb8Cfe0D9bCfafD97C0a0D1cC040D7eC0ffD58Cec8D9aCc00DddC003Dc3C000D25C0dfD36C5d1D5aC500DfaC0d4D49Cf1fDa8C00aD34D42C020D0bC0ffD46D47D56D57Cf80D8dCb00De7C009Db2Dc4C200Df8DfbC61fD85C70dDc5C900D9eCe0fDa5Cfe0D6bCfdfD86C0c0D17D5eC060D0aCecdD8aCc00DaeC001D70C0bfD45D65Cbc0D6cC0a0D4eC0efD55Ce03Db9C007D51C6bfD59C00eD61CecfD76C0b0D2dC050D3eCdd9D6aC005D33C010D1dC0ccD37Cd5eDa9C030D08Cdc0D7dCccfD67Cc0eDc6CfefD68C060D09CecdD7aCd00Dd6C0ffD66'{	select = getSliceNumber();
	run("Merge Channels...");
}




macro "Map to Line Action Tool - C000D0bD0cD0dD0eD0fD1bD1cD1fD2bD2cD2fD3bD3cD3eD3fD4bD4cD4eD4fD5bD5cD5fD6bD6cD6fD7bD7cD7fD8bD8fD9bD9eD9fDabDaeDafDb0Db3Db4Db5Db6Db7Db8Db9DbeDbfDc0Dc4Dc5Dc6Dc7Dc8DcdDceDcfDd0Dd1Dd5Dd6Dd7DdcDddDdeDdfDe0De1De2DeaDecDedDeeDefDf0Df1Df2Df3Df4Df5Df8Df9DfaDfbDfcDfdDfeDffC002Da0DaaC000Dc1De3Df7C00aD01D04D05D06D07D08D09C056D35C000D5eD8cC03aD13D93D94D99C005Da7Da8Da9C400Db1Dd4C00fD15D16D17D18D19D28D29D44D52D53D54D55D56D57D58D67D68D79C057D63C0d0D12C11eD31C014Da5C200DbaDd8C00dD42C0a2D38C111D8eC02cD25C007D1aCa00De6C777D6eD7eC0f0D23D75D85D86D87C77aD40D50D60D70C014Da4C100DccC083D91C0d1D24D36D88D96C03aD77C005Da6C700Dc9C048D89C0f0D22D95C66aD30D5aD6aC433DbcC200Dc3De9C00fD45D78C0a3D97D98Cf00DcaDcbC01dD43C117D20Cb00Dc2DdbC888D9dDadCbbbD4dC111D1dDbdC075D83C007D9aC500Db2DbbC057D64C0e0D37C44dD51D61C033Da1C00eD27D49C093D46Cc00Dd3DdaDe5C01dD48D62C009D03Cb00De7De8C669D4aD80C004D0aC100Dd2DebDf6C084D34C02bD11C036D02C900De4C555D7dC0e0D33C444DacC0a3D65C00eD26C448D3aD7aC999D1eD2dCcccD3dD8dC076D82C057D84C33dD41D71C014Da3C00dD59C01cD21C008D10D90Ca00Dd9C094D47D92C006D2aC049D66C444D2eD9cC029D39CcccD5dC075D73C067D72C043Da2C093D32C12cD81C005D00C085D74C02bD14C226D8aC666D6dC0d1D76C00eD69"{
	run("CSI Map to Line");
}